this code has many bugs please fix these
